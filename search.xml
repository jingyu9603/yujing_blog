<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[R中GEO数据的预处理]]></title>
    <url>%2F2019%2F06%2F05%2FR%E4%B8%ADGEO%E6%95%B0%E6%8D%AE%E7%9A%84%E9%A2%84%E5%A4%84%E7%90%86%2F</url>
    <content type="text"><![CDATA[获得芯片探针与gene的对应关系的三种方法： 在基因芯片的厂商的官网直接下载 从NCBI里面下载文件来解析 直接使用Bioconductor包 以下是直接使用Biocondutor包的流程： 获取平台与Bioconductor包之间的对应关系 12345678910library(BiocManager)BiocManager::install(&quot;GEOmetadb&quot;)install.packages(&quot;RSQLite&quot;)devtools::install_github(&quot;ggrothendieck/sqldf&quot;)library(GEOmetadb)library(RSQLite)library(sqldf)getSQLiteFile()con&lt;-dbConnect(RSQLite::SQLite(),&quot;GEOmetadb.sqlite&quot;)gplToBioc&lt;-dbGetQuery(con,&apos;select gpl,bioc_package,title from gpl where bioc_package is not null&apos;) 下载所需要的包 1234567for(i in 1:nrow(gplToBioc))&#123; platform=gplToBioc[i,1] platformDB=paste(platform,&quot;.db&quot;,sep = &quot;&quot;) if(platformDB %in% rownames(installed.packages()) ==FALSE)&#123; BiocManager::install(platformDB) &#125;&#125; 批量获得芯片探针与gene的对应关系 1234567891011121314151617library(hgu133a.db)library(GEOquery)#下载GEO数据集GEO&lt;-&quot;GSE24673&quot;if(!file.exists(GEO))&#123; gset&lt;-getGEO(GEO,destdir = &quot;.&quot;,getGPL = F,AnnotGPL = F) save(gset,file=GEO)&#125;data&lt;-gset[[1]]data&lt;-exprs(data)ids&lt;-toTable(hgu133aSYMBOL)data&lt;-data[ids$probe_id,]ids$median&lt;-apply(data,1,median)ids&lt;-ids[order(ids$symbol,ids$median,decreasing = T),]ids&lt;-ids[!duplicated(ids$symbol),]data&lt;-data[ids$probe_id,]rownames(data)&lt;-ids$symbol]]></content>
      <categories>
        <category>R</category>
      </categories>
      <tags>
        <tag>GEO</tag>
      </tags>
  </entry>
</search>
